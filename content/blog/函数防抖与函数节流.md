---
title: 函数防抖与函数节流
date: 2017-11-23 19:15:07
tags: javascript
---

## 前言

► 实际开发中以下场景往往由于事件频繁被触发，从而频繁执行DOM操作、资源加载等行为，导致页面卡顿甚至浏览器崩溃：

1. window对象的 resize、scroll 事件

2. 拖拽时的 mousemove 事件

3. 射击游戏中的 mousedown、keydown 事件

4. 文字输入、自动完成的 keyup 事件

► 对于 window 的 resize 事件，实际需求一般是停止改变大小n毫秒后执行；而其它事件一般是以一定的频率执行。

► 针对这两种需求就出现了 debounce (防抖) 和 throttle (节流) 两种解决办法

## 函数防抖

► 如果用手一直按住一个弹簧，它将不会弹起直到你松手为止，也就是调用动作n毫秒后才会执行该动作，如果n毫秒内再次调用则重新计算执行时间

简单实现： debounce 方法接收两个参数，一个是需要防抖动的函数 **fn** ，另一个是延迟时间 **delay**

![Markdown](http://i2.bvimg.com/603805/e072301856d82602.png)

## 函数节流

► 将水龙头拧到水以水滴的形式流出，每隔一段时间就有一滴水流出，也就是预先设定一个执行周期，调用动作的时刻不小于这个执行周期就执行它

简单实现：throttle 方法也是接收两个参数，一个是需要节流的函数 **fn** ，另一个是函数执行间隔阈值 **threshhold**

![Markdown](http://i2.bvimg.com/603805/a203d2e6fc4b12f0.png)

## 总结

可以参考一下防抖和节流与正常触发的对比效果图：
![Markdown](http://i2.bvimg.com/603805/d32393a66dcf73c1.png)

► debounce 可以想象成把很多事件压缩成了一个事件，throttle 可以想象成像阀门一样定时打开调节流量

► 简单来说，debounce 适合只执行一次的情况，比如 搜索框的自动完成：在停止输入后才提交一次ajax请求； throttle 适合每隔一定时间间隔内执行不超过一次的情况，比如 拖动滚动条、移动鼠标、滚轮事件的处理等