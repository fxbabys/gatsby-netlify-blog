---
title: 红宝书笔记集锦
date: 2019-12-08 21:11:00
tags: 读书笔记
---

这段时间在阅读红宝书做基础补足，将阅读过程中所记录的点总结一下：



##第三章 基本概念

### 3.3 变量：

不建议修改变量所保存值的类型。即固定类型，这一点与 V8 能做的优化有关。

### 3.4 数据类型：

- 3.4.1 `typeof` 操作符：
  - 特殊值 `null` 被认为是一个空的对象引用。
- 3.4.5 `Number` 类型：
  - 对于极大或极小的数值，可以用 e 表示法表示，等于 e 前面的数值乘以 10 的指数次幂。
  - 如果某次计算的结果得到了一个超出 `JavaScript` 数值范围的值，会被自动转换成特殊的 `Infinity` 值。
  - 想确定一个数值是不是有穷的（位于最小和最大的数值之间），可以使用 `isFinite()` 函数。
  - `isNaN()` 在接收到一个值以后会尝试将这个值转换为数值，任何不能被转换为数值的值都会导致这个函数返回 `true`。
  - 在基于对象调用 `isNaN()` 函数时，会首先调用对象的 `valueOf()` 方法，然后确定返回的值是否可以转换为数值，不能则基于返回值再调用 `toString()` 方法，再测试返回值。
  - `Number()` 函数的转换规则：如果是 `null` 值，返回 0。
- 3.4.7 `Object` 类型：
  - `hasOwnProperty(propertyName)`：用于检查给定的属性在当前对象实例中（而不是在实例的原型中）是否存在。

###3.5 操作符：

- 3.5.9 赋值操作符：复合赋值操作符设计的主要目的就是简化赋值操作，不会带来任何性能的提升。

###3.6 语句：

- 3.6.5 `for-in` 语句：
  - 通过 `for-in` 循环输出的属性名的顺序是不可预测的，所有属性都会被返回一次，但返回的先后次序可能会因浏览器而异。
  - 建议在使用 `for-in` 循环之前，先检测确认该对象的值不是 `null` 或者 `undefined`。
- 3.6.7 `break` 和 `continue` 语句：
  - `continue` 语句可以与 `label` 语句联用，如果使用 `label` 语句，一定要使用描述性的标签，同时不要嵌套过多的循环。
- 3.6.9 `switch` 语句：
  - 当省略 `break` 关键字时不要忘了在代码中添加注释。
  - `switch` 语句在比较值时使用的是全等操作符，因此不会发生类型转换。

###3.7 函数：

- 3.7.1 理解参数：
  - 修改 `arguments` 对象中的值会自动反映到对应的命名参数，但并不是读取这两个值会访问相同的内存空间，它们的内存空间是独立的，但值会同步。
  - 没有传递值的命名参数将自动被赋予 `undefined` 值，就跟定义了变量但又没有初始化一样。



## 第四章 变量、作用域和内存问题

###4.1 基本类型和引用类型的值：

- 4.1.4 检测类型：
  - `typeof` 在检测基本数据类型时用处更大。
  - `instanceof` 检测基本类型时始终返回 `false`，因为基本类型不是对象。

###4.2 执行环境及作用域

每个执行环境都有一个与之关联的**变量对象**，环境中定义的所有变量和函数都保存在这个对象中。

在 Web 浏览器中，全局执行环境被认为是 `window` 对象。

当代码在一个环境中执行时会创建变量对象的一个**作用域链**，用以保证对执行环境有权访问的所有变量和函数的有序访问。

- 4.2.1 延长作用域链
  - `with` 和 `catch` 语句都会在作用域链的前端添加一个变量对象，`with` 语句会将指定的对象加到作用域链中，`catch` 会创建一个新的变量对象，包含了被抛出的错误对象的声明。

###4.3 垃圾回收

- 4.3.2 引用计数：
  - 将变量设置为 `null` 意味着切断变量与它此前引用的值之间的连接。当垃圾收集器下次运行时就会删除这些值并回收它们占有的内存。
- 4.3.4 管理内存：
  - 解除引用的真正作用是让值脱离执行环境，以便垃圾收集器下次运行时将其回收。



## 第五章 引用类型

### 5.2 Array 类型

- 5.2.1 检测数组：
  - 5.2.2 转换方法：
    - 调用数组的 `toString()` 方法会返回由数组中每个值的字符串形式拼接而成的一个以逗号分隔的字符串。而调用 `valueOf()` 返回的还是数组。
    - 如果数组中某一项的值时 `null` 或者 `undefined`，则该值在 `join()`、`toLocaleString()`、`toString()` 和 `valueOf()` 方法返回的结果中以空字符串表示。
  - 5.2.5 重排序方法：`sort()` 方法会调用每个数组项的 `toString()` 转型方法，然后比较得到的字符串以确定如何排序。即使数组中的每一项都是数组，`sort()` 方法比较的也是字符串。
  - 5.2.7 位置方法：`indexOf()` 与 `lastIndexOf()` 方法使用全等操作符比较。

### 5.3 Date 类型

`Date.now()` 方法返回调用这个方法时的日期和时间的毫秒数。

在不支持它的浏览器中，使用 + 操作符把 Date 对象转成字符串也行。

### 5.4 RegExp 类型

- 5.4.2 RegExp 实例方法：正则表达式的 `valueOf()` 方法返回正则表达式本身。

### 5.5 Function 类型

```js
var sum = new Function("num1", "num2", "return num1 + num2");
```

从技术角度讲，这是一个函数表达式。但是不推荐这样使用，因为这种语法会导致解析两次代码（第一次是解析常规 ECMAScript 代码，第二次是解析传入构造函数中的字符串），从而影响性能。

- 5.5.2 函数声明与函数表达式：
  - 解析器会率先读取函数声明，并使其在执行任何代码之前可访问；而函数表达式必须等到解析器执行到它所在的代码行才会真正被解析执行。
  - 除了什么时候可以通过变量访问函数这一点区别外，函数声明与函数表达式的语法是等价的。
- 5.5.4 函数内部属性：
  - `arguments` 是一个类数组对象，包含着传入函数中的所有参数，它还有一个名叫 `callee` 的属性，该属性是一个指针，指向拥有这个 `arguments` 对象的函数。
  - `caller` 属性保存着调用当前函数的函数引用。
- 5.5.5 函数属性和方法：
  - 在 ECMAScript 5 中，`prototype` 属性是不可枚举的，因此使用 `for-in` 无法发现。

### 5.6 基本包装类型

```js
var sl = "some text"
var s2 = s1.substring(2)
```

当第二行代码访问 s1 时，访问过程处于一种读取模式，也就是要从内存中读取这个字符串的值。而在读取模式中访问字符串时，后台都会自动完成下列处理：

- 创建 String 类型的一个实例
- 在实例上调用指定的方法
- 销毁这个实例

引用类型与基本包装类型的主要区别就是对象的生存期。使用 `new` 操作符创建的引用类型的实例，在执行流离开当前作用域之前都一直保存在内存中。而自动创建的基本包装类型的对象，则只存在于一行代码的执行瞬间，然后立即被销毁。

- 5.6.1 Boolean 类型：

  - Boolean 类型的实例重写了 `valueOf()` 方法，返回基本类型值 `true` 或 `false`；重写了 `toString()` 方法，返回字符串 `"true"` 和 `"false"`。
  - 理解基本类型的布尔值与 Boolean 对象之间的区别非常重要。当然建议永远不要使用 Boolean 对象。

- 5.6.2 Number 类型：

  - `toExponential()` 返回以指数表示法表示的数值的字符串形式。
  - `toPercision()` 会根据要处理的数值决定到底是调用 `toFixed()` 还是调用 `toExponential()`。

- 5.6.3 String 类型：

  - 与 `concat()` 方法一样，`slice()`、`substr()` 和 `substring()` 也不会修改字符串本身的值，而是返回一个基本类型的字符串值。
  - `replace()` 方法：如果第二个参数是字符串，还可以使用一些特殊的字符序列，将正则表达式得到的值插入到结果字符串中。

  ```js
  	function htmlEscape(text) {
      return text.replace(/[<>"&]/g, function(match, pos, originalText) {
        switch(match) {
          case '<':
            return "&lt;";
          case '>':
            return "&gt";
          case '&':
            return "&amp;";
          case '\':
            return "&quot;"
        }
      })
    }
  ```

  实现这种转义的最简单方式，就是使用正则表达式查找这几个字符，然后定义一个能够针对每个匹配的字符返回特定 HTML 实体的函数。

### 5.7 单体内置对象

- 5.7.1 Global 对象：

  - 使用 `encodeURI()` 编码后的结果是除了空格之外的其它字符都原封不动，只有空格被替换成了 %20。而 `encodeURIComponent()` 方法则会使用对应的编码替换所有非字母数字字符。
  - URI 方法能够编码所有 Unicode 字符，而原来的方法（`decodeURI() `和 `decodeURIComponent()`）只能正确地编码 ASCII 字符。
  - ECMAScript 虽然没有指出如何直接访问 Global 对象，但 Web 浏览器都是将这个全局对象作为 window 对象的一部分加以实现的。因此，在全局作用域中声明的所有变量和函数，就都成为了 window 对象的属性。

- 5.7.2 Math 对象

  - **要找到数组中的最大最小值**，可以这样使用 `apply()` 方法：

    ```js
    var max = Math.max.apply(Math, [1, 2, 3, 4, 5])
    ```

    关键是把 Math 对象作为 `apply()` 的第一个参数，从而正确地设置 `this` 值，然后可以将任何数组作为第二个参数。